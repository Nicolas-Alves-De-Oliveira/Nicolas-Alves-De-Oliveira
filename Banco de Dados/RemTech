/* BANCO DE DADOS NO SQL SERVER */

CREATE DATABASE RemTech
GO

USE RemTech
GO

--TABELAS--

CREATE TABLE FUNCIONARIOS(
                         IDFUNCIONARIO INT PRIMARY KEY IDENTITY,
                         NOME VARCHAR(30) NOT NULL,
                         SEXO CHAR(1) NOT NULL
            CHECK (SEXO IN( 'M','F')),
                         EMAIL VARCHAR(40) UNIQUE,
                         CPF INT(15) NOT NULL UNIQUE,
                         CARGO VARCHAR(30) NOT NULL,
                         SALARIO FLOAT(10,2) NOT NULL,
 )
GO

CREATE TABLE ENDERECO(
                         IDENDERECO INT PRIMARY KEY IDENTITY(100,10),
                         RUA VARCHAR(40) NOT NULL,
                         BAIRRO VARCHAR(40) NOT NULL,
                         CIDADE VARCHAR(40) NOT NULL,
                         ESTADO CHAR(2) NOT NULL
            CHECK ( ESTADO IN('SP','RJ','MG','AC','AL','GO','PA','BA')),
                         ID_FUNCIONARIO INT UNIQUE
)
GO

CREATE TABLE TELEFONE(
                          IDTELEFONE INT PRIMARY KEY IDENTITY(1000,10),
                          TIPO CHAR(3) NOT NULL
             CHECK ( TIPO IN('RES','CEL','COM')),
                          NUMERO INT(20) NOT NULL,
                          ID_FUNCIONARIO INT
)
GO

--CHAVES E CONSTRAINTS--

ALTER TABLE ENDERECO
ADD CONSTRAINT FK_ENDERECO_FUNCIONARIOS
FOREIGN KEY( ID_FUNCIONARIO)
REFERENCES  FUNCIONARIOS(IDFUNCIONARIO)
GO

ALTER TABLE TELEFONE
ADD CONSTRAINT FK_TELEFONE_FUNCIONARIOS
FOREIGN KEY( ID_FUNCIONARIO)
REFERENCES  FUNCIONARIOS(IDFUNCIONARIO)
GO

--VIEW--

CREATE VIEW V_FUNCIONARIOS AS 
SELECT F.NOME,
             F.SEXO AS GÃŠNERO, 
             F.EMAIL, 
             F.CPF, 
             F.CARGO,
             F.SALARIO, 
             E.RUA,
             E.BAIRRO,
             E.CIDADE, 
             E.ESTADO, 
             T.TIPO, 
             T.NUMERO
FROM FUNCIONARIOS F
INNER JOIN ENDERECO E
ON F.IDFUNCIONARIO = E.ID_FUNCIONARIO
INNER JOIN TELEFONE T
ON F.IDFUNCIONARIO = T.ID_FUNCIONARIO
GO

SELECT * FROM V_FUNCIONARIOS
GO
