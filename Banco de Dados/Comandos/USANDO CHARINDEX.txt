/* USANDO CHARINDEX */

/* TABELA:

NOME       SEXO       TIPO_SANGUINEO
---------- ---------- --------------
JOAO       MASCULINO  A+ 
THIAGO     MASCULINO  A- 
JORGE      MASCULINO  O+ 
LUCAS      MASCULINO  A- 
MARIO      MASCULINO  O- 
KAIQUE     MASCULINO  O- 
NICOLAS    MASCULINO  B+ 
VINICUS    MASCULINO  B- 
NEIDE      FEMININO   A- 
NALDO      MASCULINO  O+ 
AILTON     MASCULINO  A- 
PRISCILLA  FEMININO   O+ 
*/

--QUEREMOS SABER QUANTOS FUNCIONARIOS SÃO DO TIPO POSITIVO E NEGATIVO NO SANGUE PARA UMA PESQUISA DO AMBULÁTORIO--

--USANDO CHARINDEX PARA LOCALIZAR ÍNDICES--

SELECT (CHARINDEX('+',TIPO_SANGUINEO)) AS POSITIVOS
FROM TESTE10

/*
POSITIVOS
-----------
2
0
2
0
0
0
2
0
0
2
0
2
*/

--PORÉM QUEREMOS ALGO MAIS PRÁTICO, PORÉM SE USAR O COUNT ELES CONTARÁ ATÉ OS VALORES NULOS, ENTÃO COMO RESOLVEMOS? COM UMA FUNÇÃO DE AGREGAÇÃO O SUM--

SELECT 'TIPO SANGUINEO' AS FUNCIONARIOS,
       SUM(CHARINDEX('+',TIPO_SANGUINEO) / 2) AS POSITIVOS,
       SUM(CHARINDEX('-',TIPO_SANGUINEO) / 2) AS NEGATIVOS
FROM TESTE10
GO
/*

FUNCIONARIOS   POSITIVOS   NEGATIVOS
-------------- ----------- -----------
TIPO SANGUINEO 5           7

*/

--PERFEITO--
